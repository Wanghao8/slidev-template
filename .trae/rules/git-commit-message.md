---
name: git-commit-message
description: 根据暂存区变更自动生成符合规范的 Git 提交信息（简体中文、祈使句、AI: #ID 格式）。在用户请求生成 commit message、写提交信息、或查看/提交暂存变更时使用。
---

# Git 提交信息生成

## 工作流程

1. **获取暂存区变更**：仅基于 `git diff --staged` 或当前暂存文件内容进行分析，不包含未暂存改动。
2. **提取上一提交的 ID**：从当前分支最近一条提交信息中提取 `#` 后的数字作为本次 ID；若无法提取则使用 `000000`。ID 无需自增，直接复用即可。
3. **生成并输出**：按下方格式与规则生成一条提交信息。

## 提交信息格式

```
AI: #<ID> <简短描述>
```

- **ID**：从上一条提交消息中提取的数字，缺省为 `000000`。
- **简短描述**：简体中文、祈使句、50 字以内，概括主要更改。

## 书写规则

| 规则 | 说明 |
|------|------|
| 语言 | 简体中文 |
| 句式 | 祈使句（如「修复错误」而非「修复了错误」） |
| 人称 | 避免「我」「我们」 |
| 长度 | 主标题 ≤50 字，重要细节可放在正文 |
| 优先级 | 多类改动时突出最重要的一项 |
| 质量 | 语法正确、无错别字 |

## 示例

参见 [examples.md](examples.md)。

## 执行步骤

1. 运行 `git diff --staged`（或等效方式）获取暂存 diff；若无暂存内容，提示用户先 `git add`。
2. 运行 `git log -1 --pretty=format:"%s"` 获取最近一次提交的标题，用正则从标题中提取 `#` 后的数字作为 ID（如 `AI: #1234567 修复弹窗` → `1234567`）。
3. 根据 diff 内容归纳变更，按格式生成 `AI: #<ID> <描述>`，并可选提供一行正文补充说明。
